#!/bin/bash

# shellcheck source=/dev/null
. ~/.pathrc
. ~/.aliasrc
. ~/.diffeorc

if command -v alacritty &>/dev/null; then
  # In particular, this is useful for i3-sensible-terminal which will loop
  # through various terminals, checking this env first. i3 will use the
  # i3-sensible-terminal command whenever a config error occurs. And choosing a
  # terminal that one is familiar with avoids undue pain for unfamilar
  # environments.
  export TERMINAL=alacritty
fi

# fzf
case "$SHELL" in
  *zsh) [ -f ~/.fzf.zsh ] && . ~/.fzf.zsh;;
  *bash) [ -f ~/.fzf.bash ] && . ~/.fzf.bash;;
esac

if [ "$(uname -s)" = Darwin ]; then
  ulimit -n 65536 unlimited
fi

export CGO_CPPFLAGS="$CGO_CPPFLAGS -Wno-unused-result"
export GOTMPDIR=/tmp/go/
[ -d $GOTMPDIR ] || mkdir -p $GOTMPDIR
export MANWIDTH=100
if command -v bat &>/dev/null; then
  export MANPAGER="sh -c 'col -b | bat -l man -p'"
fi

export FZF_DEFAULT_OPTS='--height 24% --reverse --border'

# Start emacs daemon automatically and idempotently with emacsclient.
# https://stackoverflow.com/a/5578718
export ALTERNATE_EDITOR=""

export EDITOR=vim

if command -v bat >/dev/null 2>&1; then
  export BAT_THEME=ansi-light
fi

# Set a custom env EDITOR_THEME to light or dark depending on the time of day,
# assuming a static time-zone. Editors are responsible for respecting this env
# in their own config.
hour=$(TZ=America/New_York date +%H)
if [ 6 -le "$hour" ] && [ "$hour" -le 19 ]; then
  export EDITOR_THEME=LIGHT
else
  export EDITOR_THEME=DARK
fi
# override
# EDITOR_THEME=DARK
# EDITOR_THEME=LIGHT
